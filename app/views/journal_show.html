<div ng-controller='InitCtrl' reveal on='mode'>

<!-- 	<div class="well well-large span7" spin='isBusy' ng-show='isBusy'></div> -->
	<h1 ng-hide='isBusy'>
		<span class='span7'>{{j.j_type}} Journal {{j.number}}</span>
		<span class='span3'>
			<button class="btn btn-primary" ng-click='edit()'>Edit</button>
			<button class="btn btn-danger" ng-click='delete()'>Delete</button>
			<button class="btn btn-warning">Post</button>
		</span>
	</h1>

	<div spin="isBusy" ng-show="isBusy" class="well well-large span8"></div>

	<h5 class='span10'>{{j.date}}</h5>
		
	<div class='span8' ng-controller='LinesCtrl'>
		<div spin="isBusy" ng-show="isBusy" class="well well-large span8"></div>
		<table class="table" ng-hide='isBusy'>
			<tr>
				<th>Date</th>
				<th>Item Code</th>
				<th>Item Name</th>
				<th>Quantity</th>
			</tr>
			<tr part='NewOrEditLine' is='row' part-controller='NewOrEditFormCtrl'>
				<td colspan=6 spin='isBusy'>
					<form class="form-inline" ng-submit='createOrUpdate()'>
						<div class='control-group'>
							<input type='text' ng-model='l.date' placeholder='Date' class='input-small' error>
						</div>
						
						<div class='control-group'>
							<input type='text' ng-model='l.item_code' placeholder='Item code' class='input-mini' error>
						</div>
						
						<div class='control-group'>
							<input type='text' ng-model='l.item_name' placeholder='Item name' error>		
						</div>
						
						<div class='control-group'>
							<input type='text' ng-model='l.qty' placeholder='Quantity' class='input-small' error>
						</div>
						
						<div class='control-group'>
							<input type='submit' class='btn btn-primary'>
						</div>
						
						<button type='button' class='btn btn-link' ng-click='cancel()'>Cancel</button>
						
						<div class='control-group' ng-show='errors.main'>
							<div ng-model='l.main' error></div>	
						</div>
						
					</form>
				</td>
			</tr>
			<tr reveal on='mode'>
				<td colspan=4>
					<div class="btn-broup">
						<button class="btn btn-link" ng-click="new()">Add new line</button>
					</div>				
				</td>
			</tr>
			<tr reveal on='mode' ng-repeat="l in lines" ng-controller='ShowFormCtrl'>
				<td>{{l.date}}</td>
				<td>{{l.item_code}}</td>
				<td>{{l.item_name}}</td>
				<td>{{l.qty}}</td>
				<td>
					<a href ng-click='edit()'>Edit</a>
				</td>
				<td>
					<a href ng-click='delete()'>Delete</a>
				</td>
			</tr>
		</table>
	</div>
	
</div>

<div ng-include='"views/del_modal.html"'></div>
<div ng-include='"views/journal_modal.html"'></div>
<!-- <div ng-include='"views/test_modal.html"'></div> -->
	


