<div ng-controller='InitCtrl'>

	<div class='row-fluid'>
		<h1 class='span12'>Journals</h1>
	</div>

	<div class='row-fluid'>
		<div class='span8'>
			<div class="well well-small" ng-hide='isBusy'>
				<button class="btn" ng-click='new()' reveal='mode'>New</button>
			</div>
			<div spin="isBusy" ng-show="isBusy" class="well well-large"></div>			
		</div>
	</div>
	
	<div class='row-fluid' ng-hide='isBusy'>
		<div class='span8'>
			<div ng-repeat="j in journals" ng-controller="ShowFormCtrlExt" class="row-fluid">
				<div class='span12 well well-small'>					
					
					<div class='row-fluid'>					
						<div class='span12'>
							<h4>
								<span class="span1">{{j.number}}</span>
								<span class="span2">{{j.date}}</span>
								<span class="span3">{{j.j_type}}</span>
								<span class="span3">
									<button class="btn btn-primary" ng-click='edit()'>Show</button>
									<button class="btn btn-danger" ng-click='delete()' reveal='mode'>Delete</button>
								</span>
								<button class="btn btn-warning">Post</button>
								<div>
									<button type="button" class="btn btn-link" ng-model="linesShown" button="showLines()" undefined-text="Loading...">Show lines</button>
								</div>
							</h4>
						</div>
					</div>
					
					<div class='row-fluid' ng-show="linesShown">
						<div class='span10'>				
							<table class="table">
								<tr>
									<th>Date</th>
									<th>Item Code</th>
									<th>Item Name</th>
									<th>Quantity</th>
								</tr>
								<tr ng-repeat="l in j.lines">
									<td>{{l.date}}</td>
									<td>{{l.item_code}}</td>
									<td>{{l.item_name}}</td>
									<td>{{l.qty}}</td>
								</tr>
							</table>
						</div>
					</div>
				</div>
				
			</div>
		</div>
	</div>
</div>

<div ng-include='"views/journal_modal.html"'></div>
<div ng-include='"views/del_modal.html"'></div>